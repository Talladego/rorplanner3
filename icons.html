<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RoR Renown Icons Helper</title>
    <style>
      :root {
        --bg: #0b1020;
        --panel: #121a2f;
        --text: #e6e8ef;
        --muted: #94a3b8;
        --accent: #60a5fa;
        --error: #ef4444;
        --tile-bg: #0f172a;
        --tile-border: #1e293b;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        background: var(--bg);
        color: var(--text);
      }
      header {
        position: sticky;
        top: 0;
        z-index: 10;
        backdrop-filter: blur(6px);
        background: linear-gradient(180deg, rgba(11,16,32,0.9), rgba(11,16,32,0.6));
        border-bottom: 1px solid var(--tile-border);
      }
      .wrap {
        max-width: 1200px;
        margin: 0 auto;
        padding: 16px 20px;
      }
      h1 {
        margin: 0 0 8px;
        font-size: 20px;
      }
      .controls {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        align-items: center;
      }
      .controls label {
        color: var(--muted);
        font-size: 13px;
      }
      .controls input {
        width: 90px;
        padding: 6px 8px;
        border-radius: 6px;
        border: 1px solid var(--tile-border);
        background: var(--panel);
        color: var(--text);
        outline: none;
      }
      .controls button {
        background: var(--accent);
        color: #0b1020;
        border: none;
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }
      .note {
        color: var(--muted);
        font-size: 12px;
        margin-top: 6px;
      }
      .grid {
        max-width: 1200px;
        margin: 16px auto;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 12px;
        padding: 0 20px 24px;
      }
      .tile {
        background: var(--tile-bg);
        border: 1px solid var(--tile-border);
        border-radius: 10px;
        padding: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 8px;
        position: relative;
        overflow: hidden;
      }
      .img-wrap {
        width: var(--size, 64px);
        height: var(--size, 64px);
        display: grid;
        place-items: center;
        background: #0b1220;
        border-radius: 8px;
        outline: 1px solid var(--tile-border);
      }
      .tile img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }
      .badge {
        position: absolute;
        top: 6px;
        right: 6px;
        background: rgba(96,165,250,0.15);
        color: var(--accent);
        border: 1px solid rgba(96,165,250,0.25);
        border-radius: 999px;
        font-size: 11px;
        padding: 2px 8px;
      }
      .label {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        font-size: 12px;
        color: var(--muted);
      }
      .url {
        font-size: 11px;
        color: #9aa7bd;
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .tile button.copy {
        margin-top: 4px;
        background: transparent;
        color: var(--accent);
        border: 1px solid rgba(96,165,250,0.25);
        padding: 4px 8px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 12px;
      }
      .tile.error .img-wrap {
        outline-color: rgba(239,68,68,0.5);
      }
      .tile.error .badge {
        background: rgba(239,68,68,0.15);
        color: var(--error);
        border-color: rgba(239,68,68,0.25);
      }
      footer {
        text-align: center;
        color: var(--muted);
        font-size: 12px;
        padding: 8px 0 18px;
      }
      .hidden {
        display: none !important;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="wrap">
        <h1>RoR Renown Icons Helper</h1>
        <div class="controls">
          <button id="prev" title="Previous 100 icons">◀ Prev 100</button>
          <label>Start <input id="start" type="number" min="0" step="1" /></label>
          <label>End <input id="end" type="number" min="0" step="1" /></label>
          <label>Size <input id="size" type="number" min="16" step="1" /></label>
          <button id="apply">Apply</button>
          <button id="next" title="Next 100 icons">Next 100 ▶</button>
          <span id="pageInfo" class="note"></span>
          <span class="note">Tip: click an icon to copy its URL. Prev/Next pages show 100 icons.</span>
        </div>
      </div>
    </header>

    <main class="grid" id="grid" aria-live="polite"></main>

    <footer>
      Data source: <code>https://armory.returnofreckoning.com/icon/{id}</code>
    </footer>

    <script>
      (function() {
        const params = new URLSearchParams(location.search);
        const PAGE_SIZE = 100;

        // If explicit params are provided, honor them; else default to 0..99 (100 icons)
        const hasStart = params.has('start');
        const hasEnd = params.has('end');
        const start = Number(params.get('start') ?? 0);
        const end = Number(params.get('end') ?? (hasStart || hasEnd ? start + PAGE_SIZE - 1 : 99));
        const size = Number(params.get('size') ?? 64);

        const startInput = document.getElementById('start');
        const endInput = document.getElementById('end');
        const sizeInput = document.getElementById('size');
        const applyBtn = document.getElementById('apply');
        const prevBtn = document.getElementById('prev');
        const nextBtn = document.getElementById('next');
        const pageInfo = document.getElementById('pageInfo');
        const grid = document.getElementById('grid');

        startInput.value = String(Number.isFinite(start) ? start : 0);
        endInput.value = String(Number.isFinite(end) ? end : 100);
        sizeInput.value = String(Number.isFinite(size) ? size : 64);

        grid.style.setProperty('--size', size + 'px');

        const BASE = 'https://armory.returnofreckoning.com/icon/';

        function makeTile(id) {
          const url = BASE + id;
          const tile = document.createElement('div');
          tile.className = 'tile';

          const badge = document.createElement('div');
          badge.className = 'badge';
          badge.textContent = '#' + id;

          const imgWrap = document.createElement('div');
          imgWrap.className = 'img-wrap';

          const img = document.createElement('img');
          img.loading = 'lazy';
          img.alt = 'icon ' + id;
          img.src = url;
          img.referrerPolicy = 'no-referrer';
          img.onerror = () => {
            tile.classList.add('error');
            // show a subtle X if it fails
            imgWrap.innerHTML = '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>';
          };

          const label = document.createElement('div');
          label.className = 'label';
          label.textContent = String(id);

          const urlEl = document.createElement('div');
          urlEl.className = 'url';
          urlEl.title = url;
          urlEl.textContent = url;

          const copy = document.createElement('button');
          copy.className = 'copy';
          copy.type = 'button';
          copy.textContent = 'Copy URL';
          copy.addEventListener('click', async (e) => {
            e.stopPropagation();
            try {
              await navigator.clipboard.writeText(url);
              copy.textContent = 'Copied!';
              setTimeout(() => (copy.textContent = 'Copy URL'), 900);
            } catch (err) {
              console.warn('Clipboard failed', err);
            }
          });

          imgWrap.appendChild(img);
          tile.appendChild(badge);
          tile.appendChild(imgWrap);
          tile.appendChild(label);
          tile.appendChild(urlEl);
          tile.appendChild(copy);

          // Clicking anywhere also copies
          tile.addEventListener('click', async () => {
            try {
              await navigator.clipboard.writeText(url);
              copy.textContent = 'Copied!';
              setTimeout(() => (copy.textContent = 'Copy URL'), 900);
            } catch {}
          });

          return tile;
        }

        function renderRange(a, b) {
          grid.innerHTML = '';
          const start = Math.max(0, Math.min(a, b));
          const end = Math.max(a, b);
          for (let i = start; i <= end; i++) {
            grid.appendChild(makeTile(i));
          }
        }

        function updatePageInfo(a, b) {
          const s = Math.max(0, Math.min(a, b));
          const e = Math.max(a, b);
          const page = Math.floor(s / PAGE_SIZE) + 1; // 1-based for humans
          pageInfo.textContent = `Page ${page} (${s}–${e})`;
        }

        function updateUrlAndRender(a, b, s) {
          const usp = new URLSearchParams({ start: String(a), end: String(b), size: String(s) });
          history.replaceState(null, '', '?' + usp.toString());
          grid.style.setProperty('--size', s + 'px');
          startInput.value = String(a);
          endInput.value = String(b);
          renderRange(a, b);
          updatePageInfo(a, b);
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        renderRange(start, end);
        updatePageInfo(start, end);

        applyBtn.addEventListener('click', () => {
          const a = Number(startInput.value || '0');
          const b = Number(endInput.value || String(a + PAGE_SIZE - 1));
          const s = Number(sizeInput.value || '64');
          updateUrlAndRender(a, b, s);
        });

        // Prev/Next behavior: snap to blocks of 100 icons
        prevBtn.addEventListener('click', () => {
          const currentStart = Number(startInput.value || '0');
          const sBlock = Math.floor(currentStart / PAGE_SIZE) * PAGE_SIZE;
          const newStart = Math.max(0, sBlock - PAGE_SIZE);
          const newEnd = newStart + PAGE_SIZE - 1;
          const s = Number(sizeInput.value || '64');
          updateUrlAndRender(newStart, newEnd, s);
        });
        nextBtn.addEventListener('click', () => {
          const currentStart = Number(startInput.value || '0');
          const sBlock = Math.floor(currentStart / PAGE_SIZE) * PAGE_SIZE;
          const newStart = sBlock + PAGE_SIZE;
          const newEnd = newStart + PAGE_SIZE - 1;
          const s = Number(sizeInput.value || '64');
          updateUrlAndRender(newStart, newEnd, s);
        });
      })();
    </script>
  </body>
</html>
